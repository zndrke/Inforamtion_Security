# 시스템 보안

## 1. 시스템 기본학습

### 1. 윈도우 기본

### 2. Unix/Linux 기본

### 3. Unix/Linux 시스템 관리

### 4. Unix/Linux 서버 보안

### 5. 시스템 해킹

## 2. Unix/Linux 서버 취약점

### 1. 계정 관리

### 2. 파일 및 디렉터리 관리

## 3. 윈도우 서버 취약점

### 1. 계정 관리

### 2. 서비스 관리

### 3. 로그 관리





## 1. 시스템 기본학습

### 1. 윈도우 기본

#### 1. 윈도우 인증과정

![image-20210326193213610](https://user-images.githubusercontent.com/45009100/112626943-4599f400-8e74-11eb-8c41-36af09787f74.png)

1. 윈도우 인증 구성요소

   1. **LSA**(Local Security Authority)
      - 모든 계정의 로그인에 대한 검증 및 시스템 자원(파일)에 대한 **접근 권한을 검사**(로컬 및 원격 로그인)
      - 계정명과 SID(Security ID)를 매칭하여 SRM이 생성한 **감사 로그를 기록**
      - NT 보안의 중심 서비스이며 **보안 서브시스템**(Security Subsystem)이라고 불림
   2. **SAM**(Security Account Manager)
      - 사용자/그룹 **계정 정보에 대한 데이터베이스를 관리**
      - 사용자 로그인 정보와 SAM 파일에 저장된 사용자 패스워드 정보를 비교해 인증 여부를 결정
      - SAM 파일은 사용자,그룹 계정 및 암호화된 **패스워드 정보를 저장하고있는 데이터베이스**로
      - 윈도우 설치 디렉터리(c:\\innt 또는 c:\\Windows)에 위치함
   3. **SRM**(security Reference Monitor)
      - 인증된 사용자에게 **SID를 부여**
      - SID를 기반으로 하여 파일이나 디렉터리에 대한 **접근을 허용할지 여부를 결정**하고 이에 대한 **감사 메시지를 생성**

2. 로컬인증

   ![image-20210326194723616](https://user-images.githubusercontent.com/45009100/112626982-564a6a00-8e74-11eb-990a-f1950abfedbe.png)

3. 원격(도메인) 인증![image-20210326194953512](https://user-images.githubusercontent.com/45009100/112627014-62cec280-8e74-11eb-97a9-3c63886a5d22.png)

4. SAM 파일 접근 통제 설정(시스템 취약점 분석·평가 항목)

   1. SAM 파일은 사용자/그룹 계정의 패스워드를 관리하고 LSA를 통한 인증을 제공하는 중요한 파일이므로 접근통제 필요
   2. 공격자로부터 SAM 파일에 대한 패스워드 공격 시도에 따른 정보 노출의 위험이 있음
   3. 보안설정
      - Administrators 및 System 그룹 외에는 SAM 파일에 대한 접근을 제한
      - 불필요한 그룹 및 계정에 대해서는 권한을 제거

#### 2. 윈도우 보안 식별자(SID : Security ID)

1. 개요
   1. 윈도우의 각 사용자나 그룹에 부여되는 고유한 식별번호
   2. 사용자가 로그인을 수행하면 **액세스 토큰이 생성**되며, 해당 토큰에는 로그인한 사용자와 그 사용자가 속한 **모든 작업 그룹들에 관한 보안 식별자(SID) 정보가 담겨있음**
   3. 액세스 토큰의 사본은 그 사용자에 의해 시작된 모든 프로세스에 할당됨
   4. 사용자 계정 및 패스워드 정보를 담고있는 SAM 파일에 SID정보가 저장되어 있음
2. SID 구조
   1. 계정별 SID 구조
      - S-1-5-21-1700005937-0000000000-2235396725-1001
      - S-1 : 윈도우 시스템을 의미
      - 5-21 : 시스템이 도메인 컨트롤러 이러나 단독 시스템임을 의미
      - 1700005937-0000000000-2235396725 : 해당 시스템만의 고유한 식별자. 윈도우를 다시 설치해도 동일한 값을 가지지 않음
      - 500,501,1000
        - 500 : 관리자
        - 501 : 게스트
        - 1000 : 일반 사용자
   2. 실습
      - 윈도우 관리명령 콘솔(WMIC) 에서 확인 가능
      - cmd > wmic > useraccount list brief

#### 3. 윈도우 인증구조

![image-20210326202027193](https://user-images.githubusercontent.com/45009100/112627052-6febb180-8e74-11eb-99eb-a6654d15f2b0.png)

1. 개요
   1. 단순히 아이디와 패스워드를 전달하여 인증하는 방식은 정보 노출 및 패스워드 재사용공격에 취약
   2. 윈도우는 **Challenge & Response 방식** 의 인증구조를 사용
      1. 인증요청
         - 인증하고자 하는 사용자가 윈도우 시스템에 인증 요청
      2. Challenge 값 생성 및 전송
         - 인증 요청을 받은 서버는 특정 규칙 또는 랜덤한 Challenge 값을 생성하여 사용자에게 전달
      3. Response 값 생성 및 전송
         - 사용자는 전달받은 Challenge 값과 사용자 패스워드 정보를 이용해 Resonse 값을 생성하여 서버에 전달
      4. Response 값 확인 및 인증 성공
         - 사용자가 전달한 Response 값을 확인하여 인증 성공 여부를 전달
2. 인증암호 알고리즘
   1. LM(Lan Manager) 해시
      - 윈도우 2000,XP의 기본 알고리즘으로 구조적으로 취약
   2. NTLM 해시 
      -  LM 해시에 MD4 해시가 추가된 형태
   3. NTLMv2
      - 비스타 이후 윈도우 시스템의 기본 인증 프로토콜
      - 기존의 알고리즘과 전혀 다른 알고리즘으로 해시값을 생성, 크래킹이 어렵다
   4. Lan Manager는 네트워크를 통한 파일 및 프린터 공유 등과 같은 작업시 인증을 담당
   5. LM 인증 수준 설정을 통해 Challenge & Response 인증 프로토콜을 결정하면 NTLMv2 사용을 권장

#### 4. 패스워드 크래킹

1. 사전대입 공격(Dictionary Attack)
   - 패스워드로 자주 사용되는 사전에 있는 단어, 키보드 자판의 일련순 등 미리 사전(Dictionary) 파일로 만든 후 이를 하나씩 대입하는 방법
2. 무작위 대입 공격(Brute Force)
   - 패스워드에 사용될 수 있는 문자열의 범위를 정하고, 그 범위내에서 가능한 모든 패스워드를 대입
   - 일반적으로 사전공격 실패 후 무차별공격을 진행
3. 레인보우 테이블
   - 레인보우 테이블은 하나의 패스워드에서 시작해 특정한 변이함수를 이용해 여러 변이된 형태의 패스워드를 생성
   - 각 변이된 패스워드의 해시를 고리처럼 연결하여 일정 수의 패스워드와 해시로 이루어진 체인을 무수히 만들어 놓은 테이블
   - 해시 테이블과 R(Reduction)함수의 반복 수행을 통해 일치하는 해시값을  통해서 패스워드를 찾아내는 방식
   - 즉, 가능한 모든 해쉬값을 저장해 놓은 표. 해시로의 변환이 필요 없어 매우 빠름
   - 레인보우테이블로 인해 12자리의 숫자, 10자리의 소문자, 8자리의 숫자+소문자 정도는 순식간에 뚫을 수 있음
   - 방어법은
     - PBKDF2, Bcrypt,Scrypt 등의 적절한 알고리즘
     - 영어, 숫자, 특수문자를 조합한 긴 암호
     - 반복된 로그인 차단
     - 2-factor 인증
     - OTP 사용
     - Salted Hash



### 2. Unix/Linux 기본

### 3. Unix/Linux 시스템 관리

### 4. Unix/Linux 서버 보안

### 5. 시스템 해킹

## 2. Unix/Linux 서버 취약점

### 1. 계정 관리

### 2. 파일 및 디렉터리 관리

## 3. 윈도우 서버 취약점

### 1. 계정 관리

### 2. 서비스 관리

### 3. 로그 관리